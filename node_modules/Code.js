var utility = require('utility/utility'),
    esprima = require('esprima'),
    esprimaConf = {raw: true, loc: true};

function clearTrackerCode(){
    var rTracker = /_tracker/g;
    
}

function Code(content, options){
    var me = this,
        opts = me._options = utility.extend({
            url : '-'
        }, options || {}),
        origContent = me._origContent = content || '',//原始代码
        execContent = me._execContent = opts.execContent || '';//页面可执行代码
        
        me._codeId = 'codeId_' + (opts.ident || utility.getIdent());
        me._formattedCode = utility.splitToLine(execContent);
        me._arrivalMapping = {};
        me._url = opts.url;
        me._fileName = utility.fileName(opts.url);
        
        me._refererId =
        me._startTime =
        me._endTime = null;
}
utility.defineProperties(Code.prototype, {
    getCodeId: function(){
        return this._codeId;
    },
    
    getOrigCode: function(){
        
    },
    
    getExecuteCode: function(){
        return this._executeCode;
    },
    
    getFormattedCode: function(){
        return this._formattedCode;
    },
    
    setReferer: function(refererId){
        this._refererId = refererId;
    },
    
    setStartTime: function(start){
        this._startTime = start;
    },
    
    setEndTime: function(end){
        this._endTime = end;
    },
    
    addArrivalId: function(arrivalId){
        var me = this,
            mapping = me._arrivalMapping,
            val = mapping[arrivalId];
        mapping[arrivalId] = val ? val + 1 : 1;
    }
    
});

module.exports = Code;